// Message types for curp client
syntax = "proto3";

package commandpb;

import "error.proto";

message ProposeRequest {
    // The serialized command
    // The original type is `Command`
    repeated bytes command = 1;
}

message ProposeResponse {
    string propose_id = 1;
    optional uint64 leader_id = 2;
    uint64 term = 3;
    oneof exe_result {
        CmdResult result = 4;
        errorpb.ProposeError error = 5;
    }
}

message WaitSyncedRequest {
    repeated string propose_id = 1;
}

message WaitSyncedResponse {
    string propose_id = 1;
    message Success {
        // The serialized command after sync result
        // The original type is Command::ASR
        bytes after_sync_result = 1;
        // The serialized command execute result
        // The original type is Command::ER
        bytes exe_result = 2;
    }
    oneof sync_result {
        Success success = 2;
        errorpb.CommandSyncError error = 3;
    }
}

message CmdResult {
    oneof result {
        // The serialized command execute result
        // The original type is Command::ER
        bytes er = 1;
        // The serialized command error
        // The original type is Command::Error
        bytes error = 2;
    }
}
